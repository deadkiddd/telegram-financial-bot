#!/usr/bin/env python3
import os
import time
import json
import requests
import threading
from datetime import datetime
from flask import Flask, request, jsonify

app = Flask(__name__)

class FinancialBot:
    def __init__(self):
        self.token = os.environ.get('TELEGRAM_BOT_TOKEN')
        self.admin_id = os.environ.get('ADMIN_ID')
        self.offset = 0
        self.running = False
        
    def send_message(self, chat_id, text, keyboard=None):
        data = {'chat_id': chat_id, 'text': text, 'parse_mode': 'Markdown'}
        if keyboard:
            data['reply_markup'] = json.dumps(keyboard)
        try:
            response = requests.post(f'https://api.telegram.org/bot{self.token}/sendMessage', json=data, timeout=10)
            return response.status_code == 200
        except Exception as e:
            print(f"Error: {e}")
            return False
    
    def handle_start(self, chat_id, user_name):
        welcome = """–ü—Ä–∏–≤–µ—Ç! –°–Ω–∏–∑—É —è —Ä–∞—Å—Å–∫–∞–∂—É –ø—Ä–æ –Ω–∞—à–∏ —É—Å–ª–æ–≤–∏—è –∏ —É—Å–ª—É–≥–∏, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º. –ê —Ç–∞–∫ –∂–µ –ø—Ä–æ —É—Å–ª–æ–≤–∏—è, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –≤—ã —Å–æ–≥–ª–∞—à–∞–µ—Ç–µ—Å—å.

–ù–∞—à –ë–æ—Ç –ø–æ–º–æ–∂–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø–ª–∞—Ç–∏—Ç—å —É—Å–ª—É–≥–∏ –µ–≤—Ä–æ–ø–µ–π—Å–∫–æ–π –∫–∞—Ä—Ç–æ–π, —Å–¥–µ–ª–∞—Ç—å –ø–µ—Ä–µ–≤–æ–¥ –Ω–∞ –∑–∞—Ä—É–±–µ–∂–Ω—ã–π —Å—á—ë—Ç –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –∫—É–ø–∏—Ç—å –¥–∏—Å–∫–æ—Ä–¥ –Ω–∏—Ç—Ä–æ.

**–°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥:**
/menu - –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∏ —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥
/help - –ø–æ–º–æ—â—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–æ—Ç–∞
/address - —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤
/price - –¥–µ–π—Å—Ç–≤—É—é—â–∏–π –ø—Ä–∞–π—Å-–ª–∏—Å—Ç

**–û–±—â–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –Ω–∞—à–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:**

1) –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—É—é —É—Å–ª—É–≥—É –ø–æ –∫–æ–º–∞–Ω–¥–µ /menu.
2) –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞–ª—é—Ç—É, –≤ –∫–æ—Ç–æ—Ä–æ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –æ–ø–ª–∞—Ç—É.
3) –û—Ç–ø—Ä–∞–≤—å—Ç–µ –≤ —á–∞—Ç —Å—É–º–º—É –æ–ø–ª–∞—Ç—ã; –±–æ—Ç —Å–∞–º —Ä–∞—Å—Å—á–∏—Ç–∞–µ—Ç –∫–æ–º–∏—Å—Å–∏—é.
4) –í—ã–±–µ—Ä–∏—Ç–µ —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã: –ª–∏–±–æ –Ω–∞ –Ω–∞—à –∞–¥—Ä–µ—Å –≤ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–µ, –ª–∏–±–æ –Ω–∞ —Ä–æ—Å—Å–∏–π—Å–∫–∏–π –±–∞–Ω–∫.
5) –ü—Ä–æ–∏–∑–≤–µ–¥–∏—Ç–µ –æ–ø–ª–∞—Ç—É –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –≤–∞–º–∏ –∞–¥—Ä–µ—Å—É. –ö–∞–∫ —Ç–æ–ª—å–∫–æ –º—ã –ø–æ–ª—É—á–∏–º —Å—Ä–µ–¥—Å—Ç–≤–∞, –º—ã –ø–æ–∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–π —É—Å–ª—É–≥–µ.

–ï—Å–ª–∏ —á—Ç–æ-–ª–∏–±–æ –∏–¥—ë—Ç –Ω–µ —Ç–∞–∫, –∏–ª–∏ –≤–∞–º –Ω—É–∂–Ω–∞ —É—Å–ª—É–≥–∞, –Ω–µ –≤–∫–ª—é—á–µ–Ω–Ω–∞—è –≤ –º–µ–Ω—é, –≤—ã –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç–µ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –Ω–∞–º, —Ç—ç–≥–Ω—É–≤ @swiwell –∏–ª–∏ @Deadkid. –û—Ç–≤–µ—Ç–∏—Ç—å –º—ã —Å–º–æ–∂–µ–º —Å 11:00 –¥–æ 22:00 –ø–æ –º—Å–∫.

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –º—ã –Ω–µ –º–æ–∂–µ–º –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞, –≤ —Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –¥–æ —á–∞—Å–∞.

**–í–∞–∂–Ω–æ:** –ï—Å–ª–∏ –≤–∞—à –ø–ª–∞—Ç–µ–∂ –±—ã–ª –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω, –Ω–æ –ø–æ –∫–∞–∫–æ–π-–ª–∏–±–æ –ø—Ä–∏—á–∏–Ω–µ –æ–ø–ª–∞—Ç–∞ —Å –Ω–∞—à–µ–π –∫–∞—Ä—Ç—ã –Ω–µ –±—ã–ª–∞ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∞, –º—ã –≤–µ—Ä–Ω–µ–º –≤–∞–º —Å—É–º–º—É –æ–ø–ª–∞—Ç—ã –∑–∞ –≤—ã—á–µ—Ç–æ–º 50% –Ω–∞—à–µ–π –∫–æ–º–∏—Å—Å–∏–∏. –í —Å–ª—É—á–∞–µ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã, –Ω–æ –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Å—Ä–µ–¥—Å—Ç–≤ –ø–æ –∫–∞–∫–æ–π-–ª–∏–±–æ –ø—Ä–∏—á–∏–Ω–µ, –≤–∞–º –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∞ —Å—É–º–º–∞ –∑–∞ –≤—ã—á–µ—Ç–æ–º 100% –Ω–∞—à–µ–π –∫–æ–º–∏—Å—Å–∏–∏. –ü—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ –∫—Ä–∏–ø—Ç–æ-–∞–¥—Ä–µ—Å–∞, –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –∫–æ–º–∏—Å—Å–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Å–µ—Ç–∏.

–ü–æ–∂–∞–ª—É–π—Å—Ç–∞ –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π –≤ —Ä—É–±–ª—è—Ö –ø–æ–∫–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç –≤—Ä—É—á–Ω—É—é.

–í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—É—é —É—Å–ª—É–≥—É:"""
        
        keyboard = {'inline_keyboard': [
            [{'text': 'üí≥ –û–ø–ª–∞—Ç–∞ –∑–∞—Ä—É–±–µ–∂–Ω–æ–π –∫–∞—Ä—Ç–æ–π', 'callback_data': 'foreign_payment'}],
            [{'text': 'üí∏ –ü–µ—Ä–µ–≤–æ–¥ –Ω–∞ –∑–∞—Ä—É–±–µ–∂–Ω—É—é –∫–∞—Ä—Ç—É', 'callback_data': 'foreign_transfer'}],
            [{'text': 'üë§ –î—Ä—É–≥–æ–µ (—Å–≤—è–∑–∞—Ç—å—Å—è —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º)', 'callback_data': 'contact_operator'}]
        ]}
        
        success = self.send_message(chat_id, welcome, keyboard)
        if chat_id != self.admin_id:
            self.send_message(self.admin_id, f"–ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {user_name} (ID: {chat_id})")
        return success
    
    def handle_menu(self, chat_id):
        menu_text = """üìã **–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —É—Å–ª—É–≥**

–í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥:

üîπ **–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —É—Å–ª—É–≥–∏:**
‚Ä¢ Discord Nitro
‚Ä¢ Spotify Premium
‚Ä¢ Netflix –ø–æ–¥–ø–∏—Å–∫–∏
‚Ä¢ YouTube Premium
‚Ä¢ ChatGPT Plus

üîπ **–ü–µ—Ä–µ–≤–æ–¥—ã –∏ –ø–ª–∞—Ç–µ–∂–∏:**
‚Ä¢ –ü–µ—Ä–µ–≤–æ–¥—ã –Ω–∞ –µ–≤—Ä–æ–ø–µ–π—Å–∫–∏–µ –∫–∞—Ä—Ç—ã
‚Ä¢ –û–ø–ª–∞—Ç–∞ –∑–∞—Ä—É–±–µ–∂–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
‚Ä¢ –ü–æ–∫—É–ø–∫–∏ –≤ –µ–≤—Ä–æ–ø–µ–π—Å–∫–∏—Ö –º–∞–≥–∞–∑–∏–Ω–∞—Ö

üîπ **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏:**
‚Ä¢ Steam, Epic Games –ø–æ–∫—É–ø–∫–∏
‚Ä¢ Apple ID –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ
‚Ä¢ Google Play –ø–ª–∞—Ç–µ–∂–∏

–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã:"""
        
        keyboard = {'inline_keyboard': [
            [{'text': 'üéÆ Discord & Gaming', 'callback_data': 'gaming_services'}],
            [{'text': 'üéµ –ü–æ–¥–ø–∏—Å–∫–∏ –∏ —Å—Ç—Ä–∏–º–∏–Ω–≥', 'callback_data': 'streaming_services'}],
            [{'text': 'üí∏ –ü–µ—Ä–µ–≤–æ–¥—ã –∏ –ø–ª–∞—Ç–µ–∂–∏', 'callback_data': 'transfer_services'}],
            [{'text': 'üìû –°–≤—è–∑–∞—Ç—å—Å—è —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º', 'callback_data': 'contact_operator'}],
            [{'text': 'üîô –ù–∞–∑–∞–¥ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é', 'callback_data': 'back_to_main'}]
        ]}
        
        return self.send_message(chat_id, menu_text, keyboard)
    
    def handle_help(self, chat_id):
        help_text = """‚ùì **–ü–æ–º–æ—â—å –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –±–æ—Ç–∞**

**–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
/menu - –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —É—Å–ª—É–≥
/help - —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞
/address - —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –¥–ª—è –æ–ø–ª–∞—Ç—ã
/price - –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –ø—Ä–∞–π—Å-–ª–∏—Å—Ç

**–ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å –∑–∞–∫–∞–∑:**
1. –í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É –≤ /menu
2. –£–∫–∞–∂–∏—Ç–µ –≤–∞–ª—é—Ç—É –æ–ø–ª–∞—Ç—ã
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å—É–º–º—É –≤ —á–∞—Ç
4. –í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã
5. –ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –ø–æ —Ä–µ–∫–≤–∏–∑–∏—Ç–∞–º
6. –û–∂–∏–¥–∞–π—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —É—Å–ª—É–≥–∏

**–ü–æ–¥–¥–µ—Ä–∂–∫–∞:**
‚Ä¢ –†–∞–±–æ—á–∏–µ —á–∞—Å—ã: 11:00 - 22:00 –ú–°–ö
‚Ä¢ –û–ø–µ—Ä–∞—Ç–æ—Ä—ã: @swiwell, @realdealkid
‚Ä¢ –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞: –¥–æ 1 —á–∞—Å–∞

**–í–∞–∂–Ω—ã–µ —É—Å–ª–æ–≤–∏—è:**
‚Ä¢ –í–æ–∑–≤—Ä–∞—Ç –ø—Ä–∏ –Ω–µ—É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç–µ: -50% –∫–æ–º–∏—Å—Å–∏–∏
‚Ä¢ –í–æ–∑–≤—Ä–∞—Ç –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã: -100% –∫–æ–º–∏—Å—Å–∏–∏
‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä—É–±–ª–µ–≤—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π - –≤—Ä—É—á–Ω—É—é

–ï—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã? –°–≤—è–∂–∏—Ç–µ—Å—å —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º!"""
        
        keyboard = {'inline_keyboard': [
            [{'text': 'üìã –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é', 'callback_data': 'menu'}],
            [{'text': 'üí¨ –°–≤—è–∑–∞—Ç—å—Å—è —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º', 'callback_data': 'contact_operator'}],
            [{'text': 'üîô –ù–∞ –≥–ª–∞–≤–Ω—É—é', 'callback_data': 'back_to_main'}]
        ]}
        
        return self.send_message(chat_id, help_text, keyboard)
    
    def handle_address(self, chat_id):
        address_text = """üìç **–†–µ–∫–≤–∏–∑–∏—Ç—ã –¥–ª—è –æ–ø–ª–∞—Ç—ã**

**–ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã–µ –∞–¥—Ä–µ—Å–∞:**

**Bep 20 :**
`0x3d128fa1ecda325c3b812d81983066e821d06c8b`

**Sol :**
`AuLgJc683BK7T2cD5e5vwNM9YXaUZpcwDe37RSiq4M2k`

**USDT (TRC20):**
`TGi5BLRCjZusbJAM5LFhdRQU6KPeXLg6Eq`

**Tether (ERC20):**
`0x3d128fa1ecda325c3b812d81983066e821d06c8b`

**–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø–µ—Ä–µ–≤–æ–¥ Bybit:**
`20504633`

**–†–æ—Å—Å–∏–π—Å–∫–∏–µ –±–∞–Ω–∫–∏:**
‚Ä¢ –¢–∏–Ω—å–∫–æ—Ñ—Ñ:  5536914013162536 –ê—Ä—Ç–µ–º –ö

*–¢–æ—á–Ω—ã–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –ø–æ—Å–ª–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞*

**–í–Ω–∏–º–∞–Ω–∏–µ:** –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–∫–∞–∑—ã–≤–∞–π—Ç–µ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –ø–µ—Ä–µ–≤–æ–¥—É –≤–∞—à Telegram ID –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–ª–∞—Ç–µ–∂–∞."""
        
        keyboard = {'inline_keyboard': [
            [{'text': 'üí≥ –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑', 'callback_data': 'foreign_payment'}],
            [{'text': 'üìã –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é', 'callback_data': 'menu'}],
            [{'text': 'üîô –ù–∞ –≥–ª–∞–≤–Ω—É—é', 'callback_data': 'back_to_main'}]
        ]}
        
        return self.send_message(chat_id, address_text, keyboard)
    
    def handle_price(self, chat_id):
        price_text = """üí∞ **–î–µ–π—Å—Ç–≤—É—é—â–∏–π –ø—Ä–∞–π—Å-–ª–∏—Å—Ç**

**–ö–æ–º–∏—Å—Å–∏–∏ –ø–æ —É—Å–ª—É–≥–∞–º:**

üîπ **–û–ø–ª–∞—Ç–∞ –∑–∞—Ä—É–±–µ–∂–Ω—ã–º–∏ –∫–∞—Ä—Ç–∞–º–∏:**
‚Ä¢ –î–æ $100 - –∫–æ–º–∏—Å—Å–∏—è 8%
‚Ä¢ $100-500 - –∫–æ–º–∏—Å—Å–∏—è 6%
‚Ä¢ –°–≤—ã—à–µ $500 - –∫–æ–º–∏—Å—Å–∏—è 5%

üîπ **–ü–µ—Ä–µ–≤–æ–¥—ã –Ω–∞ –∑–∞—Ä—É–±–µ–∂–Ω—ã–µ –∫–∞—Ä—Ç—ã:**
‚Ä¢ –î–æ ‚Ç¨200 - –∫–æ–º–∏—Å—Å–∏—è 10%
‚Ä¢ ‚Ç¨200-1000 - –∫–æ–º–∏—Å—Å–∏—è 8%
‚Ä¢ –°–≤—ã—à–µ ‚Ç¨1000 - –∫–æ–º–∏—Å—Å–∏—è 6%

*–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–º–∏—Å—Å–∏—è 3$*
*–ö—É—Ä—Å—ã –≤–∞–ª—é—Ç –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–∞–∂–¥—ã–π —á–∞—Å*

–¢–æ—á–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞."""
        
        keyboard = {'inline_keyboard': [
            [{'text': 'üí≥ –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑', 'callback_data': 'foreign_payment'}],
            [{'text': 'üìã –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é', 'callback_data': 'menu'}],
            [{'text': 'üîô –ù–∞ –≥–ª–∞–≤–Ω—É—é', 'callback_data': 'back_to_main'}]
        ]}
        
        return self.send_message(chat_id, price_text, keyboard)
    
    def handle_foreign_payment(self, chat_id, user_name):
        payment_text = """üí≥ **–û–ø–ª–∞—Ç–∞ –∑–∞—Ä—É–±–µ–∂–Ω–æ–π –∫–∞—Ä—Ç–æ–π**

–ú—ã –ø–æ–º–æ–∂–µ–º –æ–ø–ª–∞—Ç–∏—Ç—å –ª—é–±—ã–µ –∑–∞—Ä—É–±–µ–∂–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã –Ω–∞—à–µ–π –µ–≤—Ä–æ–ø–µ–π—Å–∫–æ–π –∫–∞—Ä—Ç–æ–π:

üîπ **–ß—Ç–æ –º–æ–∂–µ–º –æ–ø–ª–∞—Ç–∏—Ç—å:**
‚Ä¢ –ü–æ–¥–ø–∏—Å–∫–∏ (Netflix, Spotify, Adobe –∏ –¥—Ä.)
‚Ä¢ Gaming (Steam, Epic Games, Blizzard)
‚Ä¢ –°–µ—Ä–≤–∏—Å—ã (ChatGPT, Midjourney, Notion)
‚Ä¢ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω—ã (Amazon, eBay –∏ –¥—Ä.)
‚Ä¢ –ú–æ–±–∏–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –∏–≥—Ä—ã

**–ö–∞–∫ –æ—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑:**
1. –£–∫–∞–∂–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞/—Ç–æ–≤–∞—Ä–∞
2. –ü—Ä–∏–ª–æ–∂–∏—Ç–µ —Å—Å—ã–ª–∫—É (–µ—Å–ª–∏ –µ—Å—Ç—å)
3. –£–∫–∞–∂–∏—Ç–µ —Å—É–º–º—É –æ–ø–ª–∞—Ç—ã
4. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞–ª—é—Ç—É –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞
5. –ü—Ä–æ–∏–∑–≤–µ–¥–∏—Ç–µ –æ–ø–ª–∞—Ç—É –ø–æ –Ω–∞—à–∏–º —Ä–µ–∫–≤–∏–∑–∏—Ç–∞–º

–ö–æ–º–∏—Å—Å–∏—è: 5-8% –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—É–º–º—ã
–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: –æ—Ç 15 –º–∏–Ω—É—Ç –¥–æ 2 —á–∞—Å–æ–≤

–ì–æ—Ç–æ–≤—ã –æ—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑?"""
        
        keyboard = {'inline_keyboard': [
            [{'text': 'üìù –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑ —Å–µ–π—á–∞—Å', 'callback_data': 'create_payment_order'}],
            [{'text': 'üí∞ –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–∞—Ä–∏—Ñ—ã', 'callback_data': 'price'}],
            [{'text': 'üë§ –°–≤—è–∑–∞—Ç—å—Å—è —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º', 'callback_data': 'contact_operator'}],
            [{'text': 'üîô –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é', 'callback_data': 'menu'}]
        ]}
        
        self.send_message(chat_id, payment_text, keyboard)
        
        admin_msg = f"""üí≥ –ó–∞—è–≤–∫–∞ –Ω–∞ –æ–ø–ª–∞—Ç—É –∑–∞—Ä—É–±–µ–∂–Ω–æ–π –∫–∞—Ä—Ç–æ–π
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {user_name} (ID: {chat_id})
–í—Ä–µ–º—è: {datetime.now().strftime('%H:%M %d/%m/%Y')}
–°—Ç–∞—Ç—É—Å: –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª–æ–≤–∏–π"""
        
        return self.send_message(self.admin_id, admin_msg)
    
    def handle_foreign_transfer(self, chat_id, user_name):
        transfer_text = """üí∏ **–ü–µ—Ä–µ–≤–æ–¥ –Ω–∞ –∑–∞—Ä—É–±–µ–∂–Ω—É—é –∫–∞—Ä—Ç—É**

–ü–µ—Ä–µ–≤–æ–¥–∏–º —Å—Ä–µ–¥—Å—Ç–≤–∞ –Ω–∞ –µ–≤—Ä–æ–ø–µ–π—Å–∫–∏–µ –∏ –∞–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∏–µ –±–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ä—Ç—ã:

üîπ **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –±–∞–Ω–∫–∏:**
‚Ä¢ Visa, Mastercard (–ï–≤—Ä–æ–ø–∞)
‚Ä¢ American Express
‚Ä¢ Revolut, Wise
‚Ä¢ –ù–µ–º–µ—Ü–∫–∏–µ –±–∞–Ω–∫–∏ (Sparkasse, Deutsche Bank)
‚Ä¢ –ü–æ–ª—å—Å–∫–∏–µ –±–∞–Ω–∫–∏ (PKO, mBank)

**–ü—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ–≤–æ–¥–∞:**
1. –£–∫–∞–∂–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è
2. –°—É–º–º—É –ø–µ—Ä–µ–≤–æ–¥–∞ –≤ USD/EUR
3. –†–µ–∫–≤–∏–∑–∏—Ç—ã –∫–∞—Ä—Ç—ã –ø–æ–ª—É—á–∞—Ç–µ–ª—è
4. –ü—Ä–æ–∏–∑–≤–µ–¥–∏—Ç–µ –æ–ø–ª–∞—Ç—É + –∫–æ–º–∏—Å—Å–∏—è
5. –ü–µ—Ä–µ–≤–æ–¥ –ø–æ—Å—Ç—É–ø–∏—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 1-3 –¥–Ω–µ–π

–ö–æ–º–∏—Å—Å–∏—è: 6-10% –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—É–º–º—ã
–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞: $50
–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞: $5000 –∑–∞ —Ä–∞–∑

–ù–∞—á–Ω–µ–º –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ?"""
        
        keyboard = {'inline_keyboard': [
            [{'text': 'üìù –û—Ñ–æ—Ä–º–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥', 'callback_data': 'create_transfer_order'}],
            [{'text': 'üí∞ –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–∞—Ä–∏—Ñ—ã', 'callback_data': 'price'}],
            [{'text': 'üë§ –°–≤—è–∑–∞—Ç—å—Å—è —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º', 'callback_data': 'contact_operator'}],
            [{'text': 'üîô –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é', 'callback_data': 'menu'}]
        ]}
        
        self.send_message(chat_id, transfer_text, keyboard)
        
        admin_msg = f"""üí∏ –ó–∞—è–≤–∫–∞ –Ω–∞ –ø–µ—Ä–µ–≤–æ–¥ –Ω–∞ –∑–∞—Ä—É–±–µ–∂–Ω—É—é –∫–∞—Ä—Ç—É
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {user_name} (ID: {chat_id})
–í—Ä–µ–º—è: {datetime.now().strftime('%H:%M %d/%m/%Y')}
–°—Ç–∞—Ç—É—Å: –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª–æ–≤–∏–π"""
        
        return self.send_message(self.admin_id, admin_msg)
    
    def handle_contact_operator(self, chat_id, user_name):
        contact_text = """üë§ **–°–≤—è–∑—å —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º**

–í—ã –º–æ–∂–µ—Ç–µ —Å–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞—à–∏–º–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏ –¥–ª—è:
‚Ä¢ –ü–æ–ª—É—á–µ–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–π –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏
‚Ä¢ –û—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤  
‚Ä¢ –†–µ—à–µ–Ω–∏—è –≤–æ–∑–Ω–∏–∫—à–∏—Ö –ø—Ä–æ–±–ª–µ–º
‚Ä¢ –ü–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –≤–∞—à–µ–≥–æ –∑–∞–∫–∞–∑–∞

**–ù–∞—à–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã:**
üë®‚Äçüíº @swiwell - –æ—Å–Ω–æ–≤–Ω–æ–π –æ–ø–µ—Ä–∞—Ç–æ—Ä
üë®‚Äçüíº @realdeadlkid - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –æ–ø–µ—Ä–∞—Ç–æ—Ä

**–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã:**
üïê 11:00 - 22:00 –ø–æ –º–æ—Å–∫–æ–≤—Å–∫–æ–º—É –≤—Ä–µ–º–µ–Ω–∏
üìû –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞: –¥–æ 1 —á–∞—Å–∞ –≤ —Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è

–û–ø–µ—Ä–∞—Ç–æ—Ä —É–∂–µ —É–≤–µ–¥–æ–º–ª–µ–Ω –æ –≤–∞—à–µ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∏ —Å–∫–æ—Ä–æ —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏.

–û–ø–∏—à–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å –≤ —Å–ª–µ–¥—É—é—â–µ–º —Å–æ–æ–±—â–µ–Ω–∏–∏."""
        
        keyboard = {'inline_keyboard': [
            [{'text': 'üìã –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é', 'callback_data': 'menu'}],
            [{'text': 'üîô –ù–∞ –≥–ª–∞–≤–Ω—É—é', 'callback_data': 'back_to_main'}]
        ]}
        
        self.send_message(chat_id, contact_text, keyboard)
        
        admin_msg = f"""üë§ –ó–ê–ü–†–û–° –°–í–Ø–ó–ò –° –û–ü–ï–†–ê–¢–û–†–û–ú
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {user_name} (ID: {chat_id})
–í—Ä–µ–º—è: {datetime.now().strftime('%H:%M %d/%m/%Y')}

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å–≤—è–∑—å —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º.
–°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∏–º –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è."""
        
        return self.send_message(self.admin_id, admin_msg)
    
    def handle_create_order(self, chat_id, order_type, user_name):
        if order_type == 'payment':
            order_text = """üìù **–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –Ω–∞ –æ–ø–ª–∞—Ç—É**

–î–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:

1Ô∏è‚É£ –ù–∞–∑–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞/—Ç–æ–≤–∞—Ä–∞
2Ô∏è‚É£ –°—Å—ã–ª–∫—É (–µ—Å–ª–∏ –µ—Å—Ç—å)
3Ô∏è‚É£ –°—É–º–º—É –æ–ø–ª–∞—Ç—ã –∏ –≤–∞–ª—é—Ç—É
4Ô∏è‚É£ –õ—é–±—ã–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏

**–ü—Ä–∏–º–µ—Ä:**
"Netflix –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –º–µ—Å—è—Ü
$15.99
–ù—É–∂–Ω–∞ –ø–æ–¥–ø–∏—Å–∫–∞ –¥–ª—è —Ä–µ–≥–∏–æ–Ω–∞ –ïU"

–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä —Ä–∞—Å—Å—á–∏—Ç–∞–µ—Ç –∏—Ç–æ–≥–æ–≤—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å –∫–æ–º–∏—Å—Å–∏–µ–π –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –¥–ª—è –æ–ø–ª–∞—Ç—ã."""
        
        elif order_type == 'transfer':
            order_text = """üìù **–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –Ω–∞ –ø–µ—Ä–µ–≤–æ–¥**

–î–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –ø–µ—Ä–µ–≤–æ–¥–∞ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ:

1Ô∏è‚É£ –°—É–º–º—É –ø–µ—Ä–µ–≤–æ–¥–∞ –∏ –≤–∞–ª—é—Ç—É
2Ô∏è‚É£ –°—Ç—Ä–∞–Ω—É –ø–æ–ª—É—á–∞—Ç–µ–ª—è
3Ô∏è‚É£ –ë–∞–Ω–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª—è (–µ—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–µ–Ω)
4Ô∏è‚É£ –°—Ä–æ—á–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–≤–æ–¥–∞

**–í–Ω–∏–º–∞–Ω–∏–µ:** –†–µ–∫–≤–∏–∑–∏—Ç—ã –∫–∞—Ä—Ç—ã –ø–æ–ª—É—á–∞—Ç–µ–ª—è –±—É–¥—É—Ç –∑–∞–ø—Ä–æ—à–µ–Ω—ã –æ—Ç–¥–µ–ª—å–Ω–æ –≤ –∑–∞—â–∏—â–µ–Ω–Ω–æ–º –≤–∏–¥–µ.

**–ü—Ä–∏–º–µ—Ä:**
"‚Ç¨500 –≤ –ì–µ—Ä–º–∞–Ω–∏—é
–ë–∞–Ω–∫: Deutsche Bank
–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å (1-3 –¥–Ω—è)"

–û–ø–µ—Ä–∞—Ç–æ—Ä —Ä–∞—Å—Å—á–∏—Ç–∞–µ—Ç –∫–æ–º–∏—Å—Å–∏—é –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏."""
        else:
            order_text = "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø –∑–∞–∫–∞–∑–∞."
        
        keyboard = {'inline_keyboard': [
            [{'text': 'üë§ –°–≤—è–∑–∞—Ç—å—Å—è —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º', 'callback_data': 'contact_operator'}],
            [{'text': 'üîô –ù–∞–∑–∞–¥', 'callback_data': 'menu'}]
        ]}
        
        self.send_message(chat_id, order_text, keyboard)
        
        admin_msg = f"""üìù –ó–∞—è–≤–∫–∞ –Ω–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
–¢–∏–ø: {'–û–ø–ª–∞—Ç–∞ –∫–∞—Ä—Ç–æ–π' if order_type == 'payment' else '–ü–µ—Ä–µ–≤–æ–¥ –Ω–∞ –∫–∞—Ä—Ç—É'}
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {user_name} (ID: {chat_id})
–í—Ä–µ–º—è: {datetime.now().strftime('%H:%M %d/%m/%Y')}

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≥–æ—Ç–æ–≤ –æ—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑. –û–∂–∏–¥–∞–π—Ç–µ –¥–µ—Ç–∞–ª–∏ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö."""
        
        return self.send_message(self.admin_id, admin_msg)
    
    def handle_callback(self, chat_id, data, user_name):
        if data == 'foreign_payment':
            return self.handle_foreign_payment(chat_id, user_name)
        elif data == 'foreign_transfer':
            return self.handle_foreign_transfer(chat_id, user_name)
        elif data == 'contact_operator':
            return self.handle_contact_operator(chat_id, user_name)
        elif data == 'menu':
            return self.handle_menu(chat_id)
        elif data == 'help':
            return self.handle_help(chat_id)
        elif data == 'address':
            return self.handle_address(chat_id)
        elif data == 'price':
            return self.handle_price(chat_id)
        elif data == 'back_to_main':
            return self.handle_start(chat_id, user_name)
        elif data == 'create_payment_order':
            return self.handle_create_order(chat_id, 'payment', user_name)
        elif data == 'create_transfer_order':
            return self.handle_create_order(chat_id, 'transfer', user_name)
    
    def process_update(self, update):
        try:
            if 'message' in update:
                message = update['message']
                chat_id = str(message['chat']['id'])
                user_name = message['from'].get('first_name', '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å')
                
                if 'text' in message:
                    text = message['text'].strip()
                    
                    if text.startswith('/start'):
                        self.handle_start(chat_id, user_name)
                    elif text.startswith('/menu'):
                        self.handle_menu(chat_id)
                    elif text.startswith('/help'):
                        self.handle_help(chat_id)
                    elif text.startswith('/address'):
                        self.handle_address(chat_id)
                    elif text.startswith('/price'):
                        self.handle_price(chat_id)
                    else:
                        admin_msg = f"""üí¨ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
–û—Ç: {user_name} (ID: {chat_id})
–í—Ä–µ–º—è: {datetime.now().strftime('%H:%M %d/%m/%Y')}
–°–æ–æ–±—â–µ–Ω–∏–µ: {text}"""
                        self.send_message(self.admin_id, admin_msg)
                        
                        response = """–í–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞–Ω–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä—É. 
                        
–û–ø–µ—Ä–∞—Ç–æ—Ä –æ—Ç–≤–µ—Ç–∏—Ç –≤ —Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è (11:00-22:00 –ú–°–ö).
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —É—Å–ª—É–≥–∞–º:

/menu - —Å–ø–∏—Å–æ–∫ —É—Å–ª—É–≥
/help - –ø–æ–º–æ—â—å  
/price - —Ç–∞—Ä–∏—Ñ—ã"""
                        
                        self.send_message(chat_id, response)
            
            elif 'callback_query' in update:
                callback = update['callback_query']
                chat_id = str(callback['message']['chat']['id'])
                data = callback['data']
                user_name = callback['from'].get('first_name', '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å')
                
                self.handle_callback(chat_id, data, user_name)
                
                requests.post(f'https://api.telegram.org/bot{self.token}/answerCallbackQuery',
                            json={'callback_query_id': callback['id']}, timeout=5)
                
        except Exception as e:
            print(f"Error processing update: {e}")
    
    def poll_updates(self):
        while self.running:
            try:
                response = requests.get(f'https://api.telegram.org/bot{self.token}/getUpdates',
                                     params={'offset': self.offset, 'timeout': 30}, timeout=35)
                
                if response.status_code == 200:
                    data = response.json()
                    if data.get('ok') and data.get('result'):
                        updates = data['result']
                        
                        for update in updates:
                            self.process_update(update)
                            self.offset = update['update_id'] + 1
                        
                        if updates:
                            print(f"Processed {len(updates)} updates")
                
            except Exception as e:
                print(f"Polling error: {e}")
                time.sleep(5)
    
    def start_polling(self):
        if not self.running:
            self.running = True
            polling_thread = threading.Thread(target=self.poll_updates, daemon=True)
            polling_thread.start()
            
            if self.admin_id:
                self.send_message(self.admin_id, "üü¢ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –±–æ—Ç –∑–∞–ø—É—â–µ–Ω –Ω–∞ Render.com!")
            
            print("Financial bot polling started on Render.com")
    
    def stop_polling(self):
        self.running = False

telegram_bot = FinancialBot()

@app.route('/')
def health():
    return jsonify({'status': 'online', 'bot_active': telegram_bot.running, 'timestamp': datetime.now().isoformat()})

@app.route('/webhook', methods=['POST'])
def webhook():
    try:
        update = request.get_json()
        if update:
            telegram_bot.process_update(update)
        return "OK"
    except Exception as e:
        print(f"Webhook error: {e}")
        return "Error", 500

if __name__ == '__main__':
    telegram_bot.start_polling()
    port = int(os.environ.get('PORT', 5000))
    app.run(host='0.0.0.0', port=port, debug=False)
